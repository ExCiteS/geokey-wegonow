{% extends 'base.html' %}

{% block bodydata %}
data-project-id="{{ project.id }}"
data-project-locked="{{ project.islocked }}"
data-category-id="{{ category.id }}"
{% endblock %}

{% block title %} | Project: {{ project.name }} - Category: {{ category.name }} - Create new field{% endblock %}

{% block main %}
<div class="page-header">
    <div class="container">
        <h3 class="smaller">
            {% if project.islocked %}<span class="glyphicon glyphicon-lock" aria-hide="true"></span>{% endif %}
            <a href="{% url 'admin:project_overview' project.id %}">{{ project.name }}</a>
        </h3>

        {% include 'projects/navigation.html' %}
    </div>
</div>

<div class="container">
    {% include 'snippets/messages.html' %}

    <div class="row">
        <div class="col m8 offset-m2">
            <div class="card">
                <form  method="POST" action="#" novalidate>

                    {% csrf_token %}
                    <div class="card-content">
                        <h4 class="form-title">
                            {% if project.islocked %}<span class="glyphicon glyphicon-lock" aria-hide="true"></span>{% endif %}
                            <span>Create new field</span>
                        </h4>

                        <div class="input-field">
                            <input type="text" class="form-control input-lg" id="name" name="name" maxlength="100" required {%if data %}value="{{ data.name }}"{% endif %} />
                            <label for="name" class="control-label">Name (required)</label>
                            
                        </div>

                        <div class="input-field">
                            <textarea class="materialize-textarea" rows="5" id="description" name="description" {%if data %}value="{{ data.description }}"{% endif %}></textarea>
                            <label for="description" class="control-label">Description</label>
                            
                        </div>

                        <div class="checkbox">
                            <input type="checkbox" name="required" id="mandatory_value" {% if data.required %}checked{% endif %} />
                            <label for="mandatory_value">   <strong>A value for this field is mandatory</strong>
                                <br>Tick this box, if you want to ensure contributors provide a value for this field.
                            </label>
                        </div>

                        <div class="input-field"> 
                            <strong >Type</label>              
                            <select name="type" id="type" class="form-control" required>
                                <option value="" disable selected>Please select the data type of the field.</option>
                                {% for field in fieldtypes %}
                                    <option value="{{ field.fieldtype }}" {% if data.type == field.fieldtype %}selected{% endif %}>{{ field.type_name }}</option>
                                {% endfor %}
                            </select>
                            
                        </div>

                        <div class="row hide field-special" id="text">
                            <div class="form-group col s12">
                                <div class="checkbox">                        
                                    <input type="checkbox" name="textarea" id="as_textarea" />
                                    <label for="as_textarea" >  <strong>Display this field as textarea.</strong>
                                        <br>Tick this box, if you expect long inputs for this text field.
                                    </label>
                                </div>
                            </div>

                            <div class="input-field col s12">                    
                                <input type="number" class="form-control" id="maxlength" name="maxlength" min="0" step="1" />
                                <label for="maxlength" class="control-label">Maximum length</label>
                            </div>
                        </div>

                        <div class="row hide field-special" id="minmax">
                            <div class="input-field col s6">                    
                                <input type="number" step="0.001" class="form-control" id="minval" name="minval" placeholder="e.g.; 1.642" />
                                <label for="minval" class="control-label">Minimum value</label>
                            </div>

                            <div class="input-field col s6">                    
                                <input type="number" step="0.001" class="form-control" id="maxval" name="maxval" placeholder="e.g.; 4541.6" />
                                <label for="maxval" class="control-label">Maximum value</label>
                            </div>
                        </div>

                        <div class="row hide field-special" id="lookup">
                            <div class="col s12">
                                <div class="panel light-blue accent-2">
                                    <p>You can add accepted values after you save the new field.</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-action">
                            <div class="right-align">
                                <button type="submit" class="btn btn-primary">Save</button>
                                <a role="button" href="{% url 'admin:category_overview' project.id category.id %}" class="btn btn-link">Cancel</a>
                            </div>
                        </div>

                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block libraries %}
<script src="/static/js/admin.ui.forms.validate.js"></script>
<script src="/static/js/admin.ui.field.create.materialize.js"></script>
{% endblock %}
